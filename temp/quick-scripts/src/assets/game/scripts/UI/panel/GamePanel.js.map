{"version":3,"sources":["assets\\game\\scripts\\UI\\panel\\GamePanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { ListenerManager } from '../../../../frame/scripts/Manager/ListenerManager';\nimport { SyncData, SyncDataManager } from '../../../../frame/scripts/Manager/SyncDataManager';\nimport BaseGamePanel from '../../../../frame/scripts/UI/Panel/BaseGamePanel';\nimport { EventType } from '../../Data/EventType';\nimport { EditorManager } from '../../Manager/EditorManager';\nimport Duomaomao5_2 from '../Item/Duomaomao5_2';\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class GamePanel extends BaseGamePanel {\n    public static className = 'GamePanel';\n\n    @property(cc.Node)\n    private gameLevel: cc.Node[] = [];\n\n    start() {\n        super.start();\n        ListenerManager.on(EventType.GAME_OVER, this.gameOver, this);\n        ListenerManager.on(EventType.SUBMIT, this.submit, this);\n        ListenerManager.on(EventType.ON_NEXT_STEP, this.onNextStep, this);\n    }\n\n    onDestroy() {\n        super.onDestroy();\n        ListenerManager.off(EventType.GAME_OVER, this.gameOver, this);\n        ListenerManager.off(EventType.SUBMIT, this.submit, this);\n        ListenerManager.off(EventType.ON_NEXT_STEP, this.onNextStep, this);\n    }\n\n    private onNextStep() {\n        this.node.getChildByName('DuoMaoMao5').active = false;\n        this.node.getChildByName('DuoMaoMao5_2').active = true;\n        this.node.getChildByName('DuoMaoMao5_2').getComponent(Duomaomao5_2).init(false);\n    }\n\n    private submit(isRight) {\n        if (isRight) {\n            this.answerRight(true);\n        } else {\n            this.answerWrong(true);\n        }\n    }\n\n    /**\n     * 游戏入口\n     * 这里已经拿到数据\n     */\n    protected setPanel() {\n        super.setPanel();\n        // TODO 业务逻辑        \n        for (let i = 0; i < this.gameLevel.length; i++) {\n            this.gameLevel[i].active = false;\n        }\n        if (EditorManager.editorData.gameIndex == 0) {\n            this.gameLevel[0].active = true;\n        } else{\n            if (SyncDataManager.getSyncData().customSyncData.curStep == 0) {\n                this.gameLevel[1].active = true;\n            } else {\n                this.gameLevel[2].active = true;\n            }            \n        }\n        ListenerManager.dispatch(EventType.ENTER_GAME, false);\n    }\n\n    /**\n     * 心跳回调（当actionId不相等时才会触发）\n     * @param recovery\n     */\n    protected onRecoveryData(recovery: SyncData): void {\n        super.onRecoveryData(recovery);\n        for (let i = 0; i < this.gameLevel.length; i++) {\n            this.gameLevel[i].active = false;\n        }\n        if (EditorManager.editorData.gameIndex == 0) {\n            this.gameLevel[0].active = true;\n        } else{\n            if (SyncDataManager.getSyncData().customSyncData.curStep == 0) {\n                this.gameLevel[1].active = true;\n            } else {\n                this.gameLevel[2].active = true;\n            }            \n        }\n        ListenerManager.dispatch(EventType.ENTER_GAME, true);\n        // ListenerManager.dispatch(EventType.GAME_RECONNECT);\n    }\n\n    /**\n     * 作答正确\n     * 父类实现了数据上报\n     * @param isCurLevelFinish 本关是否完成\n     */\n    protected answerRight(isCurLevelFinish: boolean) {\n        super.answerRight(isCurLevelFinish);\n    }\n\n    /**\n     * 作答错误\n     * 父类实现了数据上报\n     * @param isCurLevelFinish 本关是否完成\n     */\n    protected answerWrong(isCurLevelFinish: boolean = false) {\n        super.answerWrong(isCurLevelFinish);\n    }\n\n    /**\n     * 游戏结束\n     * 父类实现了结算界面（游戏结束或星级评判）的弹出\n     */\n    protected gameOver() {\n        super.gameOver();\n    }\n\n    /**\n     * 重玩\n     */\n    protected onReplay() {\n        super.onReplay();\n        SyncDataManager.getSyncData().customSyncData.curLevel = 0;\n        SyncDataManager.getSyncData().customSyncData.curStep = 0;\n        SyncDataManager.getSyncData().customSyncData.curChooseColors = [];\n        SyncDataManager.getSyncData().customSyncData.curRotateAngle = [];\n        SyncDataManager.getSyncData().customSyncData.curFilledIndex = [];\n        SyncDataManager.getSyncData().customSyncData.isGameOver = false;\n        SyncDataManager.getSyncData().customSyncData.fillAreaResult = [null, null, null, null];\n        SyncDataManager.getSyncData().customSyncData.curAngleInfo = [0, 0, 0, 0];\n        SyncDataManager.getSyncData().customSyncData.curAngleInfo2 = [0, 0, 0, 0, 0];\n        SyncDataManager.getSyncData().customSyncData.fillAreaResult2 = [null, null, null, null, null];\n\n        for (let i = 0; i < this.gameLevel.length; i++) {\n            this.gameLevel[i].active = false;\n        }\n        if (EditorManager.editorData.gameIndex == 0) {\n            this.gameLevel[0].active = true;\n        } else{\n            if (SyncDataManager.getSyncData().customSyncData.curStep == 0) {\n                this.gameLevel[1].active = true;\n            } else {\n                this.gameLevel[2].active = true;\n            }            \n        }\n        ListenerManager.dispatch(EventType.ENTER_GAME, false);\n        // ListenerManager.dispatch(EventType.GAME_REPLAY);\n    }\n\n    update(dt) {\n        super.update(dt);\n    }\n}\n"]}