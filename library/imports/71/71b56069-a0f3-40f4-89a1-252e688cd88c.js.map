{"version":3,"sources":["assets\\game\\scripts\\UI\\Item\\OptionItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { ListenerManager } from \"../../../../frame/scripts/Manager/ListenerManager\";\r\nimport { SoundManager } from \"../../../../frame/scripts/Manager/SoundManager\";\r\nimport { SyncDataManager } from \"../../../../frame/scripts/Manager/SyncDataManager\";\r\nimport { HitTest } from \"../../../../frame/scripts/Utils/HitTest\";\r\nimport { Tools } from \"../../../../frame/scripts/Utils/Tools\";\r\nimport { EventType } from \"../../Data/EventType\";\r\nimport FillArea from \"./FillArea\";\r\nimport { SoundConfig } from \"./SoundConfig\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class OptionItem extends cc.Component {\r\n    @property(cc.Integer)\r\n    public index: number = 0;\r\n    @property(cc.Node)\r\n    private fillArea: cc.Node = null;\r\n\r\n    private _startPos: cc.Vec3 = null;\r\n    private _startParent: cc.Node = null;\r\n    protected onLoad(): void {\r\n        this._startParent = this.node.parent;\r\n        this._startPos = this.node.position;\r\n    }\r\n\r\n    public setOriginPos(pos: cc.Vec3, parent: cc.Node) {\r\n        this._startPos = pos;\r\n        this._startParent = parent;\r\n    }\r\n\r\n    private onDragStart(event: any) {\r\n        let pos = event.target.parent.convertToWorldSpaceAR(cc.v2(event.pos.x, event.pos.y));\r\n        // this.node.getChildByName('yinying').active = false;\r\n    }\r\n\r\n    private onDragMove(event: any) {\r\n        let pos = event.target.parent.convertToWorldSpaceAR(cc.v2(event.pos.x, event.pos.y));\r\n        ListenerManager.dispatch(EventType.DRAG_OPTION, pos);\r\n    }\r\n\r\n    private onDragEnd(event: any) {\r\n        let pos = event.target.parent.convertToWorldSpaceAR(cc.v2(event.pos.x, event.pos.y));\r\n        if (event.isClick) {\r\n            if (this.node.parent.name == this.fillArea.name) {\r\n                return;\r\n            }\r\n            let effect = this.node.getChildByName('putongdianji');\r\n            effect.active = true;\r\n            effect.position = cc.v3(0, 0);\r\n            Tools.playSpine(effect.getComponent(sp.Skeleton), 'animation', false, () => {\r\n                effect.active = false;\r\n            });\r\n            ListenerManager.dispatch(EventType.ROTATE_ITEM, this.index);\r\n        } else {\r\n            if (HitTest.posInRect(new cc.Vec2(pos.x, pos.y), this.fillArea)) {\r\n                ListenerManager.dispatch(EventType.ON_FILL_ITEM, this.node);\r\n            } else {\r\n                SoundManager.playEffect(SoundConfig.soudlist[\"错误提示\"], false);\r\n                this.reset();\r\n            }\r\n        }\r\n    }\r\n\r\n    private onClick(data: any) {\r\n        if (SyncDataManager.getSyncData().customSyncData.curStep == 1) return;\r\n        ListenerManager.dispatch(EventType.ON_CLICK_ITEM, { index: this.index, name: this.node.name });\r\n        let effect = this.node.getChildByName('putongdianji');\r\n        effect.active = true;\r\n        effect.position = cc.v3(data.pos.x, data.pos.y);\r\n        Tools.playSpine(effect.getComponent(sp.Skeleton), 'animation', false, () => {\r\n            effect.active = false;\r\n        });\r\n    }\r\n\r\n    public closeClickNode() {\r\n        this.node.getChildByName('clickNode').active = false;\r\n    }\r\n\r\n    public showClickNode() {\r\n        this.node.getChildByName('clickNode').active = true;\r\n    }\r\n\r\n    public reset() {\r\n        this.node.position = this._startPos;\r\n        this.node.parent = this._startParent;\r\n        // this.node.getChildByName('yinying').active = true;\r\n        let effect = this.node.getChildByName('putongdianji');\r\n        effect.active = false;\r\n        this.node.getChildByName('icon').active = true;\r\n        this.node.getChildByName('ani').active = false;\r\n    }\r\n}\r\n"]}